<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.7"/><style data-href="/styles.bb89a13fb06722fbab8d.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{color:#ebdbb2;direction:ltr;font-family:Consolas,Monaco,Andale Mono,monospace;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#7c6f64;color:#fbf1c7}pre[class*=language-]{margin:0;overflow:auto;padding:0}:not(pre)>code[class*=language-],pre[class*=language-]{background:#1d2021}:not(pre)>code[class*=language-]{border-radius:0;padding:.1em}.token.cdata,.token.comment,.token.prolog{color:#a89984}.token.atrule,.token.boolean,.token.delimiter,.token.important,.token.keyword,.token.selector{color:#fb4934}.token.attr-name,.token.operator,.token.punctuation{color:#a89984}.token.builtin,.token.doctype,.token.tag,.token.tag .punctuation{color:#fabd2f}.token.entity,.token.number,.token.symbol{color:#d3869b}.token.constant,.token.property,.token.variable{color:#fb4934}.token.char,.token.string{color:#b8bb26}.token.attr-value,.token.attr-value .punctuation{color:#a89984}.token.url{color:#b8bb26;text-decoration:underline}.token.function{color:#fabd2f}.token.regex{background:#b8bb26}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.inserted{background:#a89984}.token.deleted{background:#fb4934}pre[class*=language-].line-numbers{counter-reset:linenumber;padding-left:3.8em;position:relative}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{border-right:1px solid #999;font-size:100%;left:-3.8em;letter-spacing:-1px;pointer-events:none;position:absolute;top:0;-webkit-user-select:none;user-select:none;width:3em}.line-numbers-rows>span{counter-increment:linenumber;display:block}.line-numbers-rows>span:before{color:#999;content:counter(linenumber);display:block;padding-right:.8em;text-align:right}::-webkit-scrollbar{height:12px;width:12px}::-webkit-scrollbar-track{background:#222;border-radius:10px}::-webkit-scrollbar-thumb{background:#555;border:2px solid #222;border-radius:10px}::-webkit-scrollbar-thumb:hover{background:#888}::-webkit-scrollbar-horizontal{height:12px}*{scrollbar-color:#555 #222;scrollbar-width:thin}</style></head><body><div id="___gatsby"><style data-emotion="css-global 1gy5gt2">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:#e0e0e0;font-size:1.1rem;line-height:1.6;font-family:'Fira Code',monospace;font-weight:400;background-color:#121212;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#121212;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css s92abg">.css-s92abg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:100vh;}</style><div class="MuiBox-root css-s92abg"><style data-emotion="css bzqdkj">.css-bzqdkj{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:static;--AppBar-background:#00ffcc;--AppBar-color:#000000;background-color:#1a1a1a;color:#e0e0e0;box-shadow:0 2px 4px rgba(0, 0, 0, 0.5);}</style><style data-emotion="css gdvm1s">.css-gdvm1s{background-color:#1b1b1b;color:#e0e0e0;-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;box-shadow:var(--Paper-shadow);background-image:var(--Paper-overlay);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:static;--AppBar-background:#00ffcc;--AppBar-color:#000000;background-color:#1a1a1a;color:#e0e0e0;box-shadow:0 2px 4px rgba(0, 0, 0, 0.5);}</style><header class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-gdvm1s" style="--Paper-shadow:0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);--Paper-overlay:linear-gradient(rgba(255, 255, 255, 0.092), rgba(255, 255, 255, 0.092))"><style data-emotion="css awgou1">.css-awgou1{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:16px;padding-right:16px;min-height:56px;}@media (min-width:600px){.css-awgou1{padding-left:24px;padding-right:24px;}}@media (min-width:0px){@media (orientation: landscape){.css-awgou1{min-height:48px;}}}@media (min-width:600px){.css-awgou1{min-height:64px;}}</style><div class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-awgou1"><a style="text-decoration:none;margin-right:16px" href="/"><style data-emotion="css 1wvotl7">.css-1wvotl7{margin:0;font-family:'Fira Code',monospace;font-weight:500;font-size:1.25rem;line-height:1.6;color:#e0e0e0;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;-webkit-text-decoration:none;text-decoration:none;}</style><div class="MuiTypography-root MuiTypography-h6 css-1wvotl7">&gt;&gt; manjana.dev</div></a><style data-emotion="css 13tqxrv">@media (min-width:0px){.css-13tqxrv{display:none;}}@media (min-width:900px){.css-13tqxrv{display:block;}}</style><div class="MuiBox-root css-13tqxrv"><style data-emotion="css 5ww3gd">.css-5ww3gd{text-transform:none;font-weight:500;font-family:'Fira Code',monospace;font-size:0.875rem;line-height:1.75;min-width:64px;padding:6px 16px;border:0;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;padding:6px 8px;color:var(--variant-textColor);background-color:var(--variant-textBg);color:inherit;border-color:currentColor;--variant-containedBg:#424242;border-radius:6px;padding:8px 16px;box-shadow:none;}.css-5ww3gd:hover{-webkit-text-decoration:none;text-decoration:none;}.css-5ww3gd.Mui-disabled{color:rgba(255, 255, 255, 0.3);}@media (hover: hover){.css-5ww3gd:hover{--variant-containedBg:#616161;--variant-textBg:rgba(224, 224, 224, 0.08);--variant-outlinedBg:rgba(224, 224, 224, 0.08);}}</style><style data-emotion="css 1tbrjfc">.css-1tbrjfc{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-transform:none;font-weight:500;font-family:'Fira Code',monospace;font-size:0.875rem;line-height:1.75;min-width:64px;padding:6px 16px;border:0;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;padding:6px 8px;color:var(--variant-textColor);background-color:var(--variant-textBg);color:inherit;border-color:currentColor;--variant-containedBg:#424242;border-radius:6px;padding:8px 16px;box-shadow:none;}.css-1tbrjfc::-moz-focus-inner{border-style:none;}.css-1tbrjfc.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1tbrjfc{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1tbrjfc:hover{-webkit-text-decoration:none;text-decoration:none;}.css-1tbrjfc.Mui-disabled{color:rgba(255, 255, 255, 0.3);}@media (hover: hover){.css-1tbrjfc:hover{--variant-containedBg:#616161;--variant-textBg:rgba(224, 224, 224, 0.08);--variant-outlinedBg:rgba(224, 224, 224, 0.08);}}</style><a class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit css-1tbrjfc" tabindex="0" mx="2" href="/">Home</a><a class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit css-1tbrjfc" tabindex="0" mx="2" href="/projects/">Projects</a><a class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit css-1tbrjfc" tabindex="0" mx="2" href="/tech-writings/">Writings</a><a class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit css-1tbrjfc" tabindex="0" mx="2" href="/contact/">Contact</a></div><style data-emotion="css eiytc8">.css-eiytc8{text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;color:#fff;-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;--IconButton-hoverBg:rgba(255, 255, 255, 0.08);margin-right:-12px;color:inherit;margin-left:auto;}.css-eiytc8:hover{background-color:var(--IconButton-hoverBg);}@media (hover: none){.css-eiytc8:hover{background-color:transparent;}}.css-eiytc8.Mui-disabled{background-color:transparent;color:rgba(255, 255, 255, 0.3);}@media (min-width:900px){.css-eiytc8{display:none;}}</style><style data-emotion="css 1t57qrs">.css-1t57qrs{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;color:#fff;-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;--IconButton-hoverBg:rgba(255, 255, 255, 0.08);margin-right:-12px;color:inherit;margin-left:auto;}.css-1t57qrs::-moz-focus-inner{border-style:none;}.css-1t57qrs.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1t57qrs{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1t57qrs:hover{background-color:var(--IconButton-hoverBg);}@media (hover: none){.css-1t57qrs:hover{background-color:transparent;}}.css-1t57qrs.Mui-disabled{background-color:transparent;color:rgba(255, 255, 255, 0.3);}@media (min-width:900px){.css-1t57qrs{display:none;}}</style><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-edgeEnd MuiIconButton-sizeMedium css-1t57qrs" tabindex="0" type="button" aria-label="menu"><style data-emotion="css q7mezt">.css-q7mezt{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-q7mezt" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="MenuIcon"><path d="M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"></path></svg></button><style data-emotion="css 14yoxd">.css-14yoxd{z-index:1200;}</style></div></header><style data-emotion="css gcpdnc">.css-gcpdnc{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;padding:16px;}</style><div class="MuiBox-root css-gcpdnc"><style data-emotion="css 9wvnva">.css-9wvnva{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-9wvnva{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.css-9wvnva{max-width:1200px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthLg css-9wvnva"><div class="MuiContainer-root MuiContainer-maxWidthLg css-9wvnva"><style data-emotion="css 1ptamnu">.css-1ptamnu{margin:0;font-size:2.5rem;font-weight:700;color:#00ffcc;font-family:'Fira Code',monospace;line-height:1.167;margin-bottom:0.35em;}</style><h1 class="MuiTypography-root MuiTypography-h1 MuiTypography-gutterBottom css-1ptamnu">Perl ...</h1><style data-emotion="css lxo4xi">.css-lxo4xi{margin:0;font-family:'Fira Code',monospace;font-weight:400;font-size:1.5rem;line-height:1.334;color:#b3b3b3;margin-bottom:0.35em;}</style><h5 class="MuiTypography-root MuiTypography-h5 MuiTypography-gutterBottom css-lxo4xi">November 06, 2024</h5><style data-emotion="css 1upvj3t">.css-1upvj3t{margin:0;font-family:'Fira Code',monospace;font-weight:500;font-size:1.25rem;line-height:1.6;color:#b3b3b3;margin-bottom:0.35em;}</style><h6 class="MuiTypography-root MuiTypography-h6 MuiTypography-gutterBottom css-1upvj3t">5<!-- --> min read</h6><div><p>In this article, we explore a fascinating Python script that showcases a unique approach to payload encoding and
decoding. This script is designed to encode Python scripts as a sequence of files, each containing small parts of the
payload, and later decode them to reconstruct the original script. This process can be valuable in various cybersecurity
applications, such as obfuscation techniques or distributed systems where payloads need to be delivered securely.</p>
<p>The script features a set of classes that handle the encoding and decoding process, including a payload generator, file
encoder, file decoder, and an execution handler. We'll break down the functionality and the key concepts in the code to
better understand how it works and how you can leverage it in your own projects.</p>
<h1>Key Concepts and Workflow</h1>
<h2>Imports</h2>
<div class="gatsby-highlight has-highlighted-lines" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="gatsby-highlight-code-line"><span class="token keyword">import</span> glob</span><span class="token keyword">import</span> os
<span class="token keyword">import</span> platform
<span class="gatsby-highlight-code-line"><span class="token keyword">import</span> random</span><span class="token keyword">import</span> re
<span class="token keyword">import</span> sys
<span class="token keyword">from</span> os <span class="token keyword">import</span> walk
<span class="token keyword">from</span> typing <span class="token keyword">import</span> List<span class="token punctuation">,</span> Tuple</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Payload Class</h2>
<p>The Payload class takes a string and applies a random "rotation" to each character, encoding the original content into a
seemingly random sequence. This rotation is then reversed during decoding to retrieve the original payload. The process
involves encoding and decoding each character based on a random rotation sequence.</p>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">File</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ascii_char<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> rotation<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> string_index<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>ascii_char <span class="token operator">=</span> ascii_char
        self<span class="token punctuation">.</span>string_index <span class="token operator">=</span> string_index
        self<span class="token punctuation">.</span>rotation <span class="token operator">=</span> rotation


<span class="token keyword">class</span> <span class="token class-name">Payload</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> raw_content<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>raw_content<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> raw_content
        random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>rotation_sequence <span class="token operator">=</span> <span class="token punctuation">[</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>raw_content<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>raw_content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token comment"># print(self.raw_content)</span>
        <span class="token comment"># print(self.rotation_sequence)</span>

        coded_content <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token keyword">for</span> idx <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>rotation_sequence<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            raw_content_char <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>raw_content<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-16'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>raw_content_char<span class="token punctuation">)</span>
            rotation_sequence_int <span class="token operator">=</span> self<span class="token punctuation">.</span>rotation_sequence<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>
            <span class="token keyword">if</span> raw_content_char <span class="token keyword">not</span> <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'\r'</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                coded_content <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>raw_content_char<span class="token punctuation">)</span> <span class="token operator">+</span> rotation_sequence_int<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>coded_content<span class="token punctuation">)</span>
        decoded_conent <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token keyword">for</span> idx <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>rotation_sequence<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            enc_content_char <span class="token operator">=</span> coded_content<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>enc_content_char<span class="token punctuation">)</span>
            rotation_sequence_int <span class="token operator">=</span> self<span class="token punctuation">.</span>rotation_sequence<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>
            <span class="token keyword">if</span> coded_content<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'\r'</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                decoded_conent <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>enc_content_char<span class="token punctuation">)</span> <span class="token operator">-</span> rotation_sequence_int<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>decoded_conent<span class="token punctuation">)</span>
        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>File Encoder</h2>
<p>The FileEncoder class converts the encoded payload into individual files, where each file represents a portion of the
payload, encrypted with a specific rotation value. These files are named based on a combination of ASCII values and the
rotation applied to them. This approach allows us to split the payload into pieces, which can then be distributed or
stored separately.</p>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">FileEncoder</span><span class="token punctuation">:</span>
    write_files<span class="token punctuation">:</span> List<span class="token punctuation">[</span>File<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> python_script<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> idx<span class="token punctuation">,</span> char <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>python_script<span class="token punctuation">)</span><span class="token punctuation">:</span>
            idx <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>
            rotation <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>write_files<span class="token punctuation">.</span>append<span class="token punctuation">(</span>File<span class="token punctuation">(</span>ascii_char<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>rotation<span class="token punctuation">)</span><span class="token punctuation">,</span> string_index<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>idx<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>write_files<span class="token punctuation">:</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"dist/</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">.</span>ascii_char<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">.</span>rotation<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">file</span><span class="token punctuation">.</span>string_index<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">"wb+"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                rot <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">"SHIFT"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">.</span>rotation<span class="token punctuation">)</span><span class="token punctuation">)</span>
                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>rot<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>File Decoder</h2>
<p>The FileDecoder class reads the encoded files, sorts them by their indices, and reconstructs the original payload by
reversing the rotations applied during encoding. This is an example of file-based encoding, where the payload is split
and stored in separate files, only to be reassembled when needed.</p>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">FileDecoder</span><span class="token punctuation">:</span>
    read_files<span class="token punctuation">:</span> List<span class="token punctuation">[</span>Tuple<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># List[Tuple[ascii_character, str_index]]</span>

    <span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        files <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>read_files<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> <span class="token builtin">file</span><span class="token punctuation">:</span> <span class="token builtin">file</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        rendered_string <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> files<span class="token punctuation">:</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"./dist/</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">file</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">file</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                rotation <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
            rendered_string <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">int</span><span class="token punctuation">(</span>rotation<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> rendered_string

    <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>dirpath<span class="token punctuation">,</span> dirnames<span class="token punctuation">,</span> filenames<span class="token punctuation">)</span> <span class="token keyword">in</span> walk<span class="token punctuation">(</span><span class="token string">"./dist"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> filename <span class="token keyword">in</span> filenames<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>read_files<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">tuple</span><span class="token punctuation">(</span>filename<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Executor Class</h2>
<p>The Executor class ties everything together. It checks whether the script is running on a supported operating system (
Windows in this case), encodes the payload using the FileEncoder, and then decodes and executes it. The payload itself
is a Python script that, when decoded, prints a specific flag to the console.</p>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Executor</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>check_os_is_supported<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>payload <span class="token operator">=</span> <span class="token triple-quoted-string string">"""import subprocess\r\nprocess = subprocess.Popen(('python -c "import this"'), shell=True, stdout=subprocess.PIPE)\r\nprint('The flag is: '+ process.stdout.read()[4:7].decode('utf-8'))"""</span>
        self<span class="token punctuation">.</span>encoder <span class="token operator">=</span> FileEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>decoder <span class="token operator">=</span> FileDecoder<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">check_os_is_supported</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">bool</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string">"windows"</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>platform<span class="token punctuation">.</span>platform<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token string">"This application only supports Windows OS"</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">encode</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>cleanup<span class="token punctuation">(</span><span class="token punctuation">)</span>
        payload <span class="token operator">=</span> Payload<span class="token punctuation">(</span>self<span class="token punctuation">.</span>payload<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>encoder<span class="token punctuation">.</span>write<span class="token punctuation">(</span>payload<span class="token punctuation">.</span>raw_content<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>decoder<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        deciperhed_string <span class="token operator">=</span> self<span class="token punctuation">.</span>decoder<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">exec</span><span class="token punctuation">(</span>deciperhed_string<span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        files <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">"./dist/*"</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> f <span class="token keyword">in</span> files<span class="token punctuation">:</span>
            os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>f<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    executor <span class="token operator">=</span> Executor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    executor<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>
    executor<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h1>How the Code Works</h1>
<h2>The Payload Generation</h2>
<p>The payload itself is a Python script that prints out a portion of the Zen of Python (import this). The payload is first
encoded using a random rotation method that alters each character based on a random number. This makes the payload
harder to read or understand without decoding.</p>
<h2>Encoding the Payload</h2>
<p>The FileEncoder class writes each encoded character into separate files, using a combination of the character's ASCII
value and the random rotation applied to it. These files are saved in a dist directory. Each file represents a fragment
of the encoded payload.</p>
<h2>Decoding the Payload</h2>
<p>The FileDecoder class reads all the fragmented files, sorts them by their indices, and reconstructs the original payload
by reversing the rotations. The reconstructed payload is then executed using Python’s exec function.</p>
<h2>Execution</h2>
<p>The Executor class ensures that the entire process—encoding, file creation, decoding, and execution—runs smoothly. It
first encodes the payload and writes it to disk, then decodes the files and executes the payload.</p>
<h1>Potential Use Cases</h1>
<h2>Obfuscation</h2>
<p>This technique can be used to obfuscate Python scripts, making it harder to analyze or reverse-engineer the payload.</p>
<h2>Distributed Systems</h2>
<p>In scenarios where a payload needs to be split across multiple systems or devices, this method of encoding the payload
into separate pieces can help facilitate secure distribution.</p>
<h2>Secure Execution:</h2>
<p>If you need to execute a script in a secure environment where the script's contents should not be exposed in plain text,
this encoding and decoding mechanism can help maintain confidentiality.</p>
<h1>Conclusion</h1>
<p>This Python script provides a creative and technical approach to encoding and decoding payloads by leveraging file-based
encoding, random rotation, and the ability to execute the final payload after decoding. It's a great example of how
encoding can be used for security, obfuscation, and payload delivery. Understanding and implementing such methods can
provide valuable insights for developing more robust and secure applications.</p>
<p>Feel free to explore and modify the code to fit your own use cases or to further experiment with encoding techniques in
your cybersecurity tools and applications.</p></div></div></div></div><footer><style data-emotion="css twmhfa">.css-twmhfa{padding:16px;margin-top:32px;background-color:#1b1b1b;text-align:center;}</style><footer class="MuiBox-root css-twmhfa"><style data-emotion="css 1vtwbm4">.css-1vtwbm4{margin:0;font-family:'Fira Code',monospace;font-weight:400;font-size:0.875rem;line-height:1.43;color:#b3b3b3;}</style><p class="MuiTypography-root MuiTypography-body2 css-1vtwbm4">© <!-- -->2024<!-- --> manjana/blue-hexagon — all rights reserved.</p><p class="MuiTypography-root MuiTypography-body2 css-1vtwbm4">Connect with me on <style data-emotion="css 1j7qjdd">.css-1j7qjdd{-webkit-text-decoration:none;text-decoration:none;}</style><style data-emotion="css 19rvrvc">.css-19rvrvc{margin:0;font:inherit;line-height:inherit;letter-spacing:inherit;color:#00ffcc;-webkit-text-decoration:none;text-decoration:none;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-19rvrvc" target="_blank" rel="noreferrer" href="https://github.com/blue-hexagon">GitHub</a> or <a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-19rvrvc" target="_blank" rel="noreferrer" href="https://www.linkedin.com/in/your-profile">LinkedIn</a>.</p></footer></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/tech-writings/perl-101/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-7fbd6c396e0de3df456c.js\"],\"component---src-pages-404-js\":[\"/component---src-pages-404-js-b396e6e4d90fc0bc3509.js\"],\"component---src-pages-contact-js\":[\"/component---src-pages-contact-js-d8748a3d860cfb650118.js\"],\"component---src-pages-index-js\":[\"/component---src-pages-index-js-957993ec05e940064c81.js\"],\"component---src-pages-projects-index-js\":[],\"component---src-pages-tech-writings-components-blog-card-js\":[],\"component---src-pages-tech-writings-components-categories-js\":[\"/component---src-pages-tech-writings-components-categories-js-5a4568a088bd0a46ee41.js\"],\"component---src-pages-tech-writings-components-hidden-search-forms-helper-js\":[\"/component---src-pages-tech-writings-components-hidden-search-forms-helper-js-84acd7940de6f42a1db0.js\"],\"component---src-pages-tech-writings-index-js\":[\"/component---src-pages-tech-writings-index-js-19b15595399d6c1b8a69.js\"],\"component---src-pages-tech-writings-markdown-remark-frontmatter-slug-jsx\":[\"/component---src-pages-tech-writings-markdown-remark-frontmatter-slug-jsx-fb8734c0044e7c4ccfe8.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="699b603d8bf7f5c19d17";</script><script src="/webpack-runtime-b1c7cf65d709a1a4c981.js" async></script><script src="/framework-3bc4c97e01817e2fa6f4.js" async></script><script src="/app-7fbd6c396e0de3df456c.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>